<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Números Aleatorios y Distribuciones</title>
    <script type="text/javascript" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5; /* Fondo más suave */
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #004D98; /* Azul FCB */
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.2em;
            border-bottom: 2px solid #A50044; /* Grana FCB */
            padding-bottom: 10px;
        }
        h2 {
            color: #A50044; /* Grana FCB */
            margin-top: 0;
            font-size: 1.8em;
            margin-bottom: 15px;
        }
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
            justify-content: center;
        }
        .buttons-container button {
            padding: 12px 20px;
            background-color: #004D98; /* Azul FCB */
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .buttons-container button:hover {
            background-color: #A50044; /* Grana FCB al hover */
            transform: translateY(-2px);
        }
        .distribution-section {
            display: none; /* Oculto por defecto */
            margin-top: 30px;
            padding: 25px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fdfdfd;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease-in-out;
            border-left: 5px solid transparent; /* Para el indicador de activo */
        }
        .distribution-section.active {
            display: block;
            border-left-color: #004D98; /* Azul FCB para la sección activa */
        }
        .explanation p {
            margin-bottom: 15px;
            font-size: 1.05em;
        }
        .parameters {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        .parameters label {
            font-weight: bold;
            color: #555;
            flex-basis: 180px; /* Ancho fijo para las etiquetas */
        }
        .parameters input[type="number"] {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            width: 100px;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }
        .parameters input[type="number"]:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        .generate-button {
            padding: 10px 20px;
            background-color: #28a745; /* Verde para generar */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-left: auto; /* Empuja el botón a la derecha */
        }
        .generate-button:hover {
            background-color: #218838;
            transform: translateY(-1px);
        }
        .results {
            margin-top: 25px;
            background-color: #e6f7ff; /* Fondo azul claro para resultados */
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #b3e0ff;
        }
        .results h3 {
            color: #0056b3;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        .results p {
            margin: 8px 0;
            font-size: 1.05em;
        }
        .graph-container {
            margin-top: 25px;
            padding: 20px;
            background-color: #fefefe;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            min-height: 350px; /* Altura mínima para el canvas */
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative; /* Para el mensaje si no hay gráfico */
        }
        .graph-placeholder-text {
            color: #666;
            font-style: italic;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        canvas {
            max-width: 100%;
            height: auto;
            display: block; /* Asegura que el canvas no ocupe espacio si no se usa */
        }
        /* Estilos para MathJax */
        .explanation mjx-container {
            display: block; /* Asegura que las fórmulas de bloque estén en su propia línea */
            margin: 10px 0;
            overflow-x: auto; /* Permite scroll si la fórmula es muy larga */
            padding: 5px;
            background-color: #f9f9f9;
            border-left: 3px solid #ddd;
        }
        /* Ajuste para que las fórmulas en línea se vean bien */
        .explanation p strong {
            display: inline-block; /* Asegura que el "strong" no rompa la línea de la fórmula */
            margin-right: 5px; /* Pequeño espacio entre el texto y la fórmula */
        }
        /* Estilos específicos para la tabla de probabilidad */
        .probability-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .probability-table th, .probability-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        .probability-table th {
            background-color: #e0e0e0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Generador de Números Aleatorios y Análisis de Distribuciones</h1>

        <p style="text-align: center; font-size: 1.1em; margin-bottom: 30px;">
            Selecciona una distribución para ver su explicación, generar números aleatorios y calcular sus estadísticas.
        </p>

        <div class="buttons-container">
            <button onclick="showDistribution('bernoulli')">Bernoulli</button>
            <button onclick="showDistribution('binomial')">Binomial</button>
            <button onclick="showDistribution('negative-binomial')">Binomial Negativa</button>
            <button onclick="showDistribution('geometric')">Geométrica</button>
            <button onclick="showDistribution('poisson')">Poisson</button>
            <button onclick="showDistribution('hypergeometric')">Hipergeométrica</button>
            <button onclick="showDistribution('uniform')">Uniforme</button>
            <button onclick="showDistribution('normal')">Gaussiana</button>
            <button onclick="showDistribution('exponential')">Exponencial</button>
            <button onclick="showDistribution('gamma')">Gamma</button>
            <button onclick="showDistribution('ball-sum')">Suma de Pelotas</button> </div>

        <div id="bernoulli" class="distribution-section">
            <h2>Distribución de Bernoulli</h2>
            <div class="explanation">
                <p>La distribución de Bernoulli modela un experimento con solo dos posibles resultados: éxito o fracaso. La probabilidad de éxito se denota por $p$. Es la base para la distribución binomial.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = p$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = p(1-p)$
                </p>
                <p>
                    <strong>Momentos:</strong> El $k$-ésimo momento ordinario es $E[X^k] = p$.
                </p>
            </div>
            <div class="parameters">
                <label for="bernoulli-p">Probabilidad de éxito (p):</label>
                <input type="number" id="bernoulli-p" min="0" max="1" step="0.01" value="0.5">
                <label for="bernoulli-n">Cantidad de números a generar:</label>
                <input type="number" id="bernoulli-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('bernoulli')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="bernoulli-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="bernoulli-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="bernoulli-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="bernoulli-chart"></canvas>
                <div class="graph-placeholder-text" id="bernoulli-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="binomial" class="distribution-section">
            <h2>Distribución Binomial</h2>
            <div class="explanation">
                <p>La distribución binomial describe el número de éxitos en una secuencia de $n$ ensayos de Bernoulli independientes, cada uno con una probabilidad de éxito $p$.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = np$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = np(1-p)$
                </p>
                <p>
                    <strong>Momentos:</strong> El primer momento central es 0. Los momentos se derivan de la función generadora de momentos, $M_X(t) = (1-p+pe^t)^n$.
                </p>
            </div>
            <div class="parameters">
                <label for="binomial-n">Número de ensayos (n):</label>
                <input type="number" id="binomial-n" min="1" value="10">
                <label for="binomial-p">Probabilidad de éxito (p):</label>
                <input type="number" id="binomial-p" min="0" max="1" step="0.01" value="0.5">
                <label for="binomial-count">Cantidad de números a generar:</label>
                <input type="number" id="binomial-count" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('binomial')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="binomial-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="binomial-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="binomial-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="binomial-chart"></canvas>
                <div class="graph-placeholder-text" id="binomial-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="negative-binomial" class="distribution-section">
            <h2>Distribución Binomial Negativa</h2>
            <div class="explanation">
                <p>La distribución binomial negativa modela el número de fracasos ($X$) antes de que ocurra un número fijo de éxitos ($r$) en una secuencia de ensayos de Bernoulli independientes, con probabilidad de éxito $p$.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = \frac{r(1-p)}{p}$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = \frac{r(1-p)}{p^2}$
                </p>
                <p>
                    <strong>Momentos:</strong> Derivados de la función generadora de momentos.
                </p>
            </div>
            <div class="parameters">
                <label for="neg-binomial-r">Número de éxitos (r):</label>
                <input type="number" id="neg-binomial-r" min="1" value="5">
                <label for="neg-binomial-p">Probabilidad de éxito (p):</label>
                <input type="number" id="neg-binomial-p" min="0" max="1" step="0.01" value="0.5">
                <label for="neg-binomial-count">Cantidad de números a generar:</label>
                <input type="number" id="neg-binomial-count" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('negative-binomial')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="neg-binomial-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="neg-binomial-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="neg-binomial-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="negative-binomial-chart"></canvas>
                <div class="graph-placeholder-text" id="negative-binomial-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="geometric" class="distribution-section">
            <h2>Distribución Geométrica</h2>
            <div class="explanation">
                <p>La distribución geométrica modela el número de ensayos de Bernoulli necesarios para obtener el primer éxito, con probabilidad de éxito $p$.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = \frac{1}{p}$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = \frac{1-p}{p^2}$
                </p>
                <p>
                    <strong>Momentos:</strong> Derivados de la función generadora de momentos, $M_X(t) = \frac{pe^t}{1-(1-p)e^t}$.
                </p>
            </div>
            <div class="parameters">
                <label for="geometric-p">Probabilidad de éxito (p):</label>
                <input type="number" id="geometric-p" min="0.01" max="1" step="0.01" value="0.5">
                <label for="geometric-n">Cantidad de números a generar:</label>
                <input type="number" id="geometric-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('geometric')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="geometric-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="geometric-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="geometric-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="geometric-chart"></canvas>
                <div class="graph-placeholder-text" id="geometric-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="poisson" class="distribution-section">
            <h2>Distribución de Poisson</h2>
            <div class="explanation">
                <p>La distribución de Poisson modela el número de eventos que ocurren en un intervalo fijo de tiempo o espacio, si estos eventos ocurren con una tasa promedio conocida ($\lambda$) e independientemente del tiempo transcurrido desde el último evento.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = \lambda$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = \lambda$
                </p>
                <p>
                    <strong>Momentos:</strong> El primer momento es $\lambda$, el segundo momento central es $\lambda$, etc. La función generadora de momentos es $M_X(t) = e^{\lambda(e^t-1)}$.
                </p>
            </div>
            <div class="parameters">
                <label for="poisson-lambda">Tasa promedio ($\lambda$):</label>
                <input type="number" id="poisson-lambda" min="0.1" step="0.1" value="5">
                <label for="poisson-n">Cantidad de números a generar:</label>
                <input type="number" id="poisson-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('poisson')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="poisson-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="poisson-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="poisson-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="poisson-chart"></canvas>
                <div class="graph-placeholder-text" id="poisson-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="hypergeometric" class="distribution-section">
            <h2>Distribución Hipergeométrica</h2>
            <div class="explanation">
                <p>La distribución hipergeométrica describe la probabilidad de obtener $k$ éxitos en $n$ extracciones sin reemplazo de una población finita que contiene $M$ éxitos y $N-M$ fracasos.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = n \frac{M}{N}$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = n \frac{M}{N} \frac{N-M}{N} \frac{N-n}{N-1}$
                </p>
                <p>
                    <strong>Momentos:</strong> Más complejos de calcular directamente.
                </p>
            </div>
            <div class="parameters">
                <label for="hyper-N">Tamaño total de la población (N):</label>
                <input type="number" id="hyper-N" min="1" value="50">
                <label for="hyper-M">Número de éxitos en la población (M):</label>
                <input type="number" id="hyper-M" min="0" value="20">
                <label for="hyper-n">Número de extracciones (n):</label>
                <input type="number" id="hyper-n" min="1" value="10">
                <label for="hyper-count">Cantidad de números a generar:</label>
                <input type="number" id="hyper-count" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('hypergeometric')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="hypergeometric-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="hypergeometric-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="hypergeometric-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="hypergeometric-chart"></canvas>
                <div class="graph-placeholder-text" id="hypergeometric-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="uniform" class="distribution-section">
            <h2>Distribución Uniforme</h2>
            <div class="explanation">
                <p>La distribución uniforme asigna la misma probabilidad a cada valor dentro de un intervalo definido $[a, b]$. Puede ser discreta o continua.</p>
                <p>
                    <strong>Esperanza Matemática (continua):</strong> $E[X] = \frac{a+b}{2}$
                </p>
                <p>
                    <strong>Varianza (continua):</strong> $Var[X] = \frac{(b-a)^2}{12}$
                </p>
                <p>
                    <strong>Momentos:</strong> Los momentos dependen del intervalo.
                </p>
            </div>
            <div class="parameters">
                <label for="uniform-a">Límite inferior (a):</label>
                <input type="number" id="uniform-a" value="0">
                <label for="uniform-b">Límite superior (b):</label>
                <input type="number" id="uniform-b" value="1">
                <label for="uniform-n">Cantidad de números a generar:</label>
                <input type="number" id="uniform-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('uniform')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="uniform-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="uniform-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="uniform-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="uniform-chart"></canvas>
                <div class="graph-placeholder-text" id="uniform-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="normal" class="distribution-section">
            <h2>Distribución Gaussiana (Normal)</h2>
            <div class="explanation">
                <p>La distribución normal es una distribución de probabilidad continua y simétrica, ampliamente utilizada en estadística. Se caracteriza por su media ($\mu$) y su desviación estándar ($\sigma$). Su forma de campana la hace fundamental en muchas aplicaciones.</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = \mu$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = \sigma^2$
                </p>
                <p>
                    <strong>Momentos:</strong> Los momentos centrales impares son 0. Los momentos centrales pares son más complejos y están relacionados con $\sigma$. La función generadora de momentos es $M_X(t) = e^{\mu t + \frac{1}{2}\sigma^2 t^2}$.
                </p>
            </div>
            <div class="parameters">
                <label for="normal-mu">Media ($\mu$):</label>
                <input type="number" id="normal-mu" value="0">
                <label for="normal-sigma">Desviación estándar ($\sigma$):</label>
                <input type="number" id="normal-sigma" min="0.1" step="0.1" value="1">
                <label for="normal-n">Cantidad de números a generar:</label>
                <input type="number" id="normal-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('normal')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="normal-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="normal-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="normal-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="normal-chart"></canvas>
                <div class="graph-placeholder-text" id="normal-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="exponential" class="distribution-section">
            <h2>Distribución Exponencial</h2>
            <div class="explanation">
                <p>La distribución exponencial describe el tiempo entre eventos en un proceso de Poisson, es decir, eventos que ocurren continuamente e independientemente a una tasa promedio constante ($\lambda$).</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = \frac{1}{\lambda}$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = \frac{1}{\lambda^2}$
                </p>
                <p>
                    <strong>Momentos:</strong> El $k$-ésimo momento ordinario es $E[X^k] = \frac{k!}{\lambda^k}$. La función generadora de momentos es $M_X(t) = \frac{\lambda}{\lambda-t}$.
                </p>
            </div>
            <div class="parameters">
                <label for="exponential-lambda">Tasa ($\lambda$):</label>
                <input type="number" id="exponential-lambda" min="0.01" step="0.01" value="0.5">
                <label for="exponential-n">Cantidad de números a generar:</label>
                <input type="number" id="exponential-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('exponential')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="exponential-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="exponential-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="exponential-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="exponential-chart"></canvas>
                <div class="graph-placeholder-text" id="exponential-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="gamma" class="distribution-section">
            <h2>Distribución Gamma</h2>
            <div class="explanation">
                <p>La distribución Gamma es una distribución de probabilidad continua que modela la suma de $k$ variables aleatorias exponenciales independientes e idénticamente distribuidas. Se caracteriza por un parámetro de forma ($k$) y un parámetro de escala ($\theta$).</p>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[X] = k\theta$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[X] = k\theta^2$
                </p>
                <p>
                    <strong>Momentos:</strong> Los momentos se pueden derivar usando la función Gamma. La función generadora de momentos es $M_X(t) = (1-\theta t)^{-k}$.
                </p>
            </div>
            <div class="parameters">
                <label for="gamma-k">Parámetro de forma (k):</label>
                <input type="number" id="gamma-k" min="0.1" step="0.1" value="2">
                <label for="gamma-theta">Parámetro de escala ($\theta$):</label>
                <input type="number" id="gamma-theta" min="0.1" step="0.1" value="1">
                <label for="gamma-n">Cantidad de números a generar:</label>
                <input type="number" id="gamma-n" min="1" value="100">
                <button class="generate-button" onclick="generateNumbers('gamma')">Generar</button>
            </div>
            <div class="results">
                <h3>Resultados</h3>
                <p><strong>Números Generados:</strong> <span id="gamma-generated"></span></p>
                <p><strong>Media Observada:</strong> <span id="gamma-mean"></span></p>
                <p><strong>Varianza Observada:</strong> <span id="gamma-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="gamma-chart"></canvas>
                <div class="graph-placeholder-text" id="gamma-placeholder-text">Haz clic en "Generar" para ver la gráfica.</div>
            </div>
        </div>

        <div id="ball-sum" class="distribution-section">
            <h2>Distribución de la Suma de Números al Sacar Pelotas</h2>
            <div class="explanation">
                <p>Se tiene una urna con 4 pelotas numeradas del 1 al 4. Se sacan dos pelotas al azar sin reemplazo. La variable aleatoria $Z$ es la suma de los números de las pelotas sacadas.</p>
                <p>Calcularemos todas las posibles combinaciones de 2 pelotas y la suma de sus números para determinar la distribución de probabilidad de $Z$.</p>
                <p>
                    Las posibles combinaciones (sin importar el orden) y sus sumas son:
                </p>
                <ul>
                    <li>(1, 2) &rarr; Suma = 3</li>
                    <li>(1, 3) &rarr; Suma = 4</li>
                    <li>(1, 4) &rarr; Suma = 5</li>
                    <li>(2, 3) &rarr; Suma = 5</li>
                    <li>(2, 4) &rarr; Suma = 6</li>
                    <li>(3, 4) &rarr; Suma = 7</li>
                </ul>
                <p>El número total de combinaciones posibles es $\binom{4}{2} = \frac{4!}{2!(4-2)!} = \frac{4 \times 3}{2 \times 1} = 6$.</p>
                <p>A continuación se muestra la distribución de probabilidad de $Z$:</p>
                <table class="probability-table">
                    <thead>
                        <tr>
                            <th>Valor de Z ($z$)</th>
                            <th>Probabilidad $P(Z=z)$</th>
                        </tr>
                    </thead>
                    <tbody id="ball-sum-probabilities">
                        </tbody>
                </table>
                <p>
                    <strong>Esperanza Matemática:</strong> $E[Z] = \sum z \cdot P(Z=z)$
                </p>
                <p>
                    <strong>Varianza:</strong> $Var[Z] = E[Z^2] - (E[Z])^2$
                </p>
            </div>
            <div class="parameters">
                <button class="generate-button" onclick="generateNumbers('ball-sum')">Calcular y Mostrar</button>
            </div>
            <div class="results">
                <h3>Resultados de la Distribución</h3>
                <p><strong>Media Teórica ($E[Z]$):</strong> <span id="ball-sum-mean"></span></p>
                <p><strong>Varianza Teórica ($Var[Z]$):</strong> <span id="ball-sum-variance"></span></p>
            </div>
            <div class="graph-container">
                <canvas id="ball-sum-chart"></canvas>
                <div class="graph-placeholder-text" id="ball-sum-placeholder-text">Haz clic en "Calcular y Mostrar" para ver la gráfica de la distribución.</div>
            </div>
        </div>
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let currentChart = null; // Variable para almacenar la instancia del gráfico actual

        // Configuración de MathJax para asegurar el procesamiento en línea
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']] // Habilita $...$ para fórmulas en línea
            },
            svg: {
                fontCache: 'global'
            }
        };


        function showDistribution(distributionId) {
            const sections = document.querySelectorAll('.distribution-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(distributionId).classList.add('active');

            // Limpiar resultados y ocultar placeholder del gráfico al cambiar de distribución
            const generatedSpan = document.getElementById(distributionId + '-generated');
            const meanSpan = document.getElementById(distributionId + '-mean');
            const varianceSpan = document.getElementById(distributionId + '-variance');
            if (generatedSpan) generatedSpan.textContent = '';
            if (meanSpan) meanSpan.textContent = '';
            if (varianceSpan) varianceSpan.textContent = '';

            const placeholderText = document.getElementById(distributionId + '-placeholder-text');
            if (placeholderText) placeholderText.style.display = 'block';

            // Destruir el gráfico anterior si existe
            if (currentChart) {
                currentChart.destroy();
                currentChart = null;
            }

            // IMPORTANTE: Re-renderizar MathJax para la nueva sección activa
            // Usamos typesetPromise para asegurar que se procese después de que el DOM esté listo
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise();
            }
        }

        function calculateMean(arr) {
            if (arr.length === 0) return 0;
            const sum = arr.reduce((a, b) => a + b, 0);
            return sum / arr.length;
        }

        function calculateVariance(arr, mean) {
            if (arr.length === 0) return 0;
            const sumOfSquares = arr.reduce((a, b) => a + Math.pow(b - mean, 2), 0);
            return sumOfSquares / arr.length; // Para la varianza poblacional
        }

        // Funciones para generación de números aleatorios
        // Nota: Estas son implementaciones básicas y pueden no ser perfectas para todas las distribuciones.
        // Para aplicaciones críticas, se recomienda usar librerías de estadística más robustas.

        function generateBernoulli(p) {
            return Math.random() < p ? 1 : 0;
        }

        function generateBinomial(n, p) {
            let successes = 0;
            for (let i = 0; i < n; i++) {
                if (Math.random() < p) {
                    successes++;
                }
            }
            return successes;
        }

        // Implementación de Box-Muller para Normal
        function generateNormal(mu, sigma) {
            let u1 = Math.random();
            let u2 = Math.random();
            let z0 = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
            return z0 * sigma + mu;
        }

        // Función para generar números de una distribución de Poisson
        // Usando el algoritmo de Knuth
        function generatePoisson(lambda) {
            if (lambda <= 0) return 0; // Manejo de caso límite
            let L = Math.exp(-lambda);
            let k = 0;
            let p_prod = 1; // Renombrado a p_prod para evitar conflicto con el parámetro p en otras funciones
            do {
                k++;
                p_prod *= Math.random();
            } while (p_prod > L);
            return k - 1;
        }

        function generateGeometric(p) {
            // Número de ensayos hasta el primer éxito (incluyendo el éxito)
            // Se asume la definición que incluye el éxito (PMF: (1-p)^(k-1) * p)
            if (p <= 0 || p > 1) return NaN; // Validar p
            return Math.floor(Math.log(Math.random()) / Math.log(1 - p)) + 1;
        }

        function generateNegativeBinomial(r, p) {
            // Genera el número de fracasos (X) hasta r éxitos.
            // Sumamos r veces el número de fracasos de una geométrica.
            // Cada geométrica (con nuestra implementación) da el número de ensayos_totales hasta el primer éxito.
            // Así que cada llamada a generateGeometric(p) - 1 nos da los fracasos en ese "intento"
            if (r <= 0 || p <= 0 || p > 1) return NaN; // Validar parámetros
            let failures = 0;
            for (let i = 0; i < r; i++) {
                failures += (generateGeometric(p) - 1); // generateGeometric devuelve ensayos_totales, restamos el éxito
            }
            return failures;
        }


        function generateHypergeometric(N, M, n) {
            if (N < 0 || M < 0 || n < 0 || M > N || n > N) {
                console.error("Parámetros de Hipergeométrica inválidos.");
                return NaN;
            }

            let population = [];
            for (let i = 0; i < M; i++) population.push(1); // Éxitos
            for (let i = 0; i < N - M; i++) population.push(0); // Fracasos

            let successes = 0;
            // No hacemos una copia profunda de la población si N es muy grande,
            // pero para N=50, copiar el array está bien.
            let tempPopulation = [...population]; 

            for (let i = 0; i < n; i++) {
                if (tempPopulation.length === 0) break; // No hay más elementos
                let randomIndex = Math.floor(Math.random() * tempPopulation.length);
                let drawn = tempPopulation.splice(randomIndex, 1)[0];
                if (drawn === 1) {
                    successes++;
                }
            }
            return successes;
        }

        function generateUniform(a, b) {
            if (a >= b) {
                console.error("Parámetros de Uniforme inválidos: 'a' debe ser menor que 'b'.");
                return NaN;
            }
            return a + (b - a) * Math.random();
        }

        function generateExponential(lambda) {
            if (lambda <= 0) {
                console.error("Parámetros de Exponencial inválidos: lambda debe ser > 0.");
                return NaN;
            }
            return -Math.log(1 - Math.random()) / lambda;
        }

        // Pseudo-generador para Gamma usando el algoritmo de Marsaglia y Tsang (simplificado)
        // Adaptado de múltiples fuentes, para k > 0.
        function generateGamma(k, theta) {
            if (k <= 0 || theta <= 0) {
                console.error("Parámetros de Gamma inválidos: k e theta deben ser > 0.");
                return NaN;
            }

            if (k < 1) { // Algoritmo de Ahrens y Dieter para k < 1
                let p, Y, u, v;
                do {
                    u = Math.random();
                    v = Math.random();
                    if (u === 0) u = 0.00000001; // Evitar log(0)
                    Y = Math.pow(u, 1/k);
                    p = Y + Math.pow(v, 1/(1-k));
                } while (p > 1);
                return (Y / p) * generateExponential(1 / theta); // Multiplica por una exponencial para ajustar escala
            } else if (k === 1) {
                return generateExponential(1 / theta); // Gamma(1,theta) es Exponencial(1/theta)
            } else { // Algoritmo de Marsaglia y Tsang para k > 1
                let d = k - 1/3;
                let c = 1 / Math.sqrt(9 * d);
                let x, v, u;
                do {
                    x = generateNormal(0, 1); // Z ~ N(0,1)
                    v = (1 + c * x);
                    v = v * v * v;
                    u = Math.random();
                } while (u >= 1 - 0.0331 * x * x * x * x && Math.log(u) >= 0.5 * x * x + d * (1 - v + Math.log(v)));
                return d * v * theta;
            }
        }

        // Función específica para la distribución de la suma de pelotas
        function calculateBallSumDistribution() {
            const balls = [1, 2, 3, 4];
            const combinations = [];
            
            // Generar todas las combinaciones únicas de 2 pelotas
            for (let i = 0; i < balls.length; i++) {
                for (let j = i + 1; j < balls.length; j++) {
                    combinations.push([balls[i], balls[j]]);
                }
            }

            const sums = combinations.map(pair => pair[0] + pair[1]);
            const totalCombinations = sums.length; // Esto debería ser 6

            // Contar la frecuencia de cada suma
            const sumCounts = {};
            sums.forEach(s => {
                sumCounts[s] = (sumCounts[s] || 0) + 1;
            });

            // Calcular las probabilidades
            const probabilities = {};
            let expectedValue = 0;
            let expectedValueSquared = 0; // Para calcular la varianza

            const sortedSums = Object.keys(sumCounts).map(Number).sort((a, b) => a - b);

            sortedSums.forEach(s => {
                const prob = sumCounts[s] / totalCombinations;
                probabilities[s] = prob;
                expectedValue += s * prob;
                expectedValueSquared += (s * s) * prob;
            });

            const variance = expectedValueSquared - (expectedValue * expectedValue);

            return {
                sums: sortedSums,
                probabilities: probabilities,
                expectedValue: expectedValue,
                variance: variance,
                allSums: sums // Para la visualización de datos brutos si fuera necesario
            };
        }


        function generateNumbers(distributionType) {
            let numbers = [];
            let count;
            let params = {};

            // Ocultar el texto del placeholder antes de generar
            const placeholderText = document.getElementById(distributionType + '-placeholder-text');
            if (placeholderText) placeholderText.style.display = 'none';

            if (distributionType === 'ball-sum') {
                const ballSumData = calculateBallSumDistribution();
                
                // Actualizar la tabla de probabilidades
                const tableBody = document.getElementById('ball-sum-probabilities');
                tableBody.innerHTML = ''; // Limpiar contenido anterior
                ballSumData.sums.forEach(s => {
                    const row = tableBody.insertRow();
                    const cellZ = row.insertCell();
                    const cellP = row.insertCell();
                    cellZ.textContent = s;
                    cellP.textContent = ballSumData.probabilities[s].toFixed(4);
                });

                // Actualizar la esperanza y varianza
                document.getElementById('ball-sum-mean').textContent = ballSumData.expectedValue.toFixed(4);
                document.getElementById('ball-sum-variance').textContent = ballSumData.variance.toFixed(4);

                // Preparar datos para el gráfico
                const labels = ballSumData.sums.map(String); // Convertir números a string para las etiquetas del gráfico
                const dataForChart = labels.map(label => ballSumData.probabilities[Number(label)]);

                drawChart('ball-sum', dataForChart, labels, 'Probabilidad'); // Pasar 'Probabilidad' como label para el eje Y
                
            } else {
                // Lógica existente para otras distribuciones
                switch (distributionType) {
                    case 'bernoulli':
                        params.p = parseFloat(document.getElementById('bernoulli-p').value);
                        count = parseInt(document.getElementById('bernoulli-n').value);
                        if (isNaN(params.p) || params.p < 0 || params.p > 1) { alert("P de Bernoulli debe ser entre 0 y 1."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateBernoulli(params.p));
                        }
                        break;
                    case 'binomial':
                        params.n = parseInt(document.getElementById('binomial-n').value);
                        params.p = parseFloat(document.getElementById('binomial-p').value);
                        count = parseInt(document.getElementById('binomial-count').value);
                        if (isNaN(params.n) || params.n < 1) { alert("N de Binomial debe ser al menos 1."); return; }
                        if (isNaN(params.p) || params.p < 0 || params.p > 1) { alert("P de Binomial debe ser entre 0 y 1."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateBinomial(params.n, params.p));
                        }
                        break;
                    case 'negative-binomial':
                        params.r = parseInt(document.getElementById('neg-binomial-r').value);
                        params.p = parseFloat(document.getElementById('neg-binomial-p').value);
                        count = parseInt(document.getElementById('neg-binomial-count').value);
                        if (isNaN(params.r) || params.r < 1) { alert("R de Binomial Negativa debe ser al menos 1."); return; }
                        if (isNaN(params.p) || params.p < 0 || params.p > 1) { alert("P de Binomial Negativa debe ser entre 0 y 1."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateNegativeBinomial(params.r, params.p));
                        }
                        break;
                    case 'geometric':
                        params.p = parseFloat(document.getElementById('geometric-p').value);
                        count = parseInt(document.getElementById('geometric-n').value);
                        if (isNaN(params.p) || params.p <= 0 || params.p > 1) { alert("P de Geométrica debe ser entre (0, 1]."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateGeometric(params.p));
                        }
                        break;
                    case 'poisson':
                        params.lambda = parseFloat(document.getElementById('poisson-lambda').value);
                        count = parseInt(document.getElementById('poisson-n').value);
                        if (isNaN(params.lambda) || params.lambda <= 0) { alert("Lambda de Poisson debe ser mayor que 0."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generatePoisson(params.lambda));
                        }
                        break;
                    case 'hypergeometric':
                        params.N = parseInt(document.getElementById('hyper-N').value);
                        params.M = parseInt(document.getElementById('hyper-M').value);
                        params.n = parseInt(document.getElementById('hyper-n').value);
                        count = parseInt(document.getElementById('hyper-count').value);
                        if (isNaN(params.N) || params.N < 1) { alert("N de Hipergeométrica debe ser al menos 1."); return; }
                        if (isNaN(params.M) || params.M < 0 || params.M > params.N) { alert("M de Hipergeométrica debe ser entre 0 y N."); return; }
                        if (isNaN(params.n) || params.n < 0 || params.n > params.N) { alert("n de Hipergeométrica debe ser entre 0 y N."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateHypergeometric(params.N, params.M, params.n));
                        }
                        break;
                    case 'uniform':
                        params.a = parseFloat(document.getElementById('uniform-a').value);
                        params.b = parseFloat(document.getElementById('uniform-b').value);
                        count = parseInt(document.getElementById('uniform-n').value);
                        if (isNaN(params.a) || isNaN(params.b) || params.a >= params.b) { alert("'a' de Uniforme debe ser menor que 'b'."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateUniform(params.a, params.b));
                        }
                        break;
                    case 'normal':
                        params.mu = parseFloat(document.getElementById('normal-mu').value);
                        params.sigma = parseFloat(document.getElementById('normal-sigma').value);
                        count = parseInt(document.getElementById('normal-n').value);
                        if (isNaN(params.mu)) { alert("Media (mu) de Gaussiana es requerida."); return; }
                        if (isNaN(params.sigma) || params.sigma <= 0) { alert("Desviación estándar (sigma) de Gaussiana debe ser mayor que 0."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateNormal(params.mu, params.sigma));
                        }
                        break;
                    case 'exponential':
                        params.lambda = parseFloat(document.getElementById('exponential-lambda').value);
                        count = parseInt(document.getElementById('exponential-n').value);
                        if (isNaN(params.lambda) || params.lambda <= 0) { alert("Tasa (lambda) de Exponencial debe ser mayor que 0."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateExponential(params.lambda));
                        }
                        break;
                    case 'gamma':
                        params.k = parseFloat(document.getElementById('gamma-k').value);
                        params.theta = parseFloat(document.getElementById('gamma-theta').value);
                        count = parseInt(document.getElementById('gamma-n').value);
                        if (isNaN(params.k) || params.k <= 0) { alert("Forma (k) de Gamma debe ser mayor que 0."); return; }
                        if (isNaN(params.theta) || params.theta <= 0) { alert("Escala (theta) de Gamma debe ser mayor que 0."); return; }
                        if (isNaN(count) || count < 1) { alert("Cantidad de números debe ser al menos 1."); return; }
                        for (let i = 0; i < count; i++) {
                            numbers.push(generateGamma(params.k, params.theta));
                        }
                        break;
                    default:
                        console.error("Distribución no reconocida.");
                        return;
                }

                const mean = calculateMean(numbers);
                const variance = calculateVariance(numbers, mean);

                // Mostrar solo los primeros 50 números para no saturar la pantalla
                const displayNumbers = numbers.slice(0, 50).map(n => n.toFixed(4)).join(', ') + (numbers.length > 50 ? '...' : '');

                document.getElementById(distributionType + '-generated').textContent = displayNumbers;
                document.getElementById(distributionType + '-mean').textContent = mean.toFixed(4);
                document.getElementById(distributionType + '-variance').textContent = variance.toFixed(4);

                drawChart(distributionType, numbers);
            }

            // IMPORTANTE: Re-renderizar MathJax después de actualizar el contenido (por si las fórmulas cambian o se añaden)
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise();
            }
        }

        // Modificación de la función drawChart para permitir pasar labels y un título de eje Y personalizados
        function drawChart(distributionType, data, customLabels = null, yAxisLabel = 'Frecuencia') {
            const ctx = document.getElementById(distributionType + '-chart').getContext('2d');

            // Destruir el gráfico anterior si existe
            if (currentChart) {
                currentChart.destroy();
            }

            let chartType = 'bar'; // Predeterminado para discretas
            let labels;
            let counts;

            if (customLabels && data) { // Si se proporcionan etiquetas y datos personalizados (para ball-sum)
                labels = customLabels;
                counts = data;
            }
            else if (['bernoulli', 'binomial', 'negative-binomial', 'geometric', 'poisson', 'hypergeometric'].includes(distributionType)) {
                // Distribuciones discretas: Contar ocurrencias de cada valor
                const valueCounts = {};
                data.forEach(d => {
                    const roundedValue = Math.round(d); // Redondear para agrupar valores discretos
                    valueCounts[roundedValue] = (valueCounts[roundedValue] || 0) + 1;
                });
                labels = Object.keys(valueCounts).sort((a, b) => a - b);
                counts = labels.map(label => valueCounts[label]);
            } else {
                // Distribuciones continuas: Crear bins para el histograma
                chartType = 'bar'; // Chart.js no tiene un tipo 'histograma' directo, usamos barras
                const min = Math.min(...data);
                const max = Math.max(...data);
                const numBins = Math.min(20, Math.max(5, Math.floor(data.length / 5))); // Ajustable, mínimo 5 bins, máximo 20, o menos si hay pocos datos
                if (numBins < 2 || max === min) { // Manejar casos con pocos datos o todos iguales
                    labels = [min.toFixed(2)];
                    counts = [data.length];
                } else {
                    const binWidth = (max - min) / numBins;
                    const bins = Array(numBins).fill(0);
                    labels = [];

                    for (let i = 0; i < numBins; i++) {
                        const binStart = min + i * binWidth;
                        const binEnd = min + (i + 1) * binWidth;
                        labels.push(`${binStart.toFixed(2)} - ${binEnd.toFixed(2)}`);
                    }

                    data.forEach(value => {
                        let binIndex = Math.floor((value - min) / binWidth);
                        if (binIndex === numBins) binIndex--; // Para el valor máximo que cae en el último bin
                        if (binIndex >= 0 && binIndex < numBins) {
                            bins[binIndex]++;
                        }
                    });
                    counts = bins;
                }
            }

            currentChart = new Chart(ctx, {
                type: chartType,
                data: {
                    labels: labels,
                    datasets: [{
                        label: yAxisLabel === 'Probabilidad' ? 'Probabilidad P(Z=z)' : 'Frecuencia de Números Generados',
                        data: counts,
                        backgroundColor: '#004D98CC', /* Azul FCB con transparencia */
                        borderColor: '#004D98',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Valores / Rangos',
                                color: '#555'
                            },
                            ticks: {
                                color: '#666'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: yAxisLabel, // Usar el label personalizado para el eje Y
                                color: '#555'
                            },
                            ticks: {
                                color: '#666'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#333'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${yAxisLabel}: ${context.parsed.y.toFixed(4)}`;
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>